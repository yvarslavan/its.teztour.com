<!DOCTYPE html>
<html>
<head>
    <title>–¢–µ—Å—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π Opera</title>
    <style>
        body { font-family: Arial; padding: 20px; background: #f0f0f0; }
        .test-btn {
            padding: 15px 30px;
            font-size: 18px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin: 10px;
            display: block;
        }
        .test-btn:hover { background: #0056b3; }
        .result {
            margin: 20px 0;
            padding: 15px;
            border-radius: 5px;
            background: white;
            border-left: 4px solid #007bff;
        }
    </style>
</head>
<body>
    <h1>üîî –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π Opera</h1>

    <button class="test-btn" onclick="testBasicNotification()">
        1. –ë–∞–∑–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    </button>

    <button class="test-btn" onclick="testPersistentNotification()">
        2. –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
    </button>

    <button class="test-btn" onclick="testWithSound()">
        3. –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ –∑–≤—É–∫–æ–º
    </button>

    <button class="test-btn" onclick="testMultiple()">
        4. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
    </button>

    <button class="test-btn" onclick="checkSettings()">
        5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    </button>

    <div id="results"></div>

    <script>
        function log(message) {
            const results = document.getElementById('results');
            results.innerHTML += `<div class="result">${message}</div>`;
            console.log(message);
        }

        function testBasicNotification() {
            log('üß™ –¢–µ—Å—Ç 1: –ë–∞–∑–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ...');

            if (!('Notification' in window)) {
                log('‚ùå Notifications API –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è');
                return;
            }

            if (Notification.permission !== 'granted') {
                log('‚ùå –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –Ω–µ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª–µ–Ω–æ: ' + Notification.permission);
                return;
            }

            try {
                const notification = new Notification('–¢–ï–°–¢ 1: –ë–∞–∑–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', {
                    body: '–≠—Ç–æ –ø—Ä–æ—Å—Ç–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ. –í—ã –¥–æ–ª–∂–Ω—ã –µ–≥–æ —É–≤–∏–¥–µ—Ç—å!',
                    icon: 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNkYPhfDwAChwGA60e6kgAAAABJRU5ErkJggg=='
                });

                log('‚úÖ –ë–∞–∑–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ');

                notification.onclick = () => {
                    log('üëÜ –ö–ª–∏–∫ –ø–æ –±–∞–∑–æ–≤–æ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω!');
                    notification.close();
                };

                setTimeout(() => {
                    notification.close();
                    log('‚è∞ –ë–∞–∑–æ–≤–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–æ —á–µ—Ä–µ–∑ 5 —Å–µ–∫—É–Ω–¥');
                }, 5000);

            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ' + error.message);
            }
        }

        function testPersistentNotification() {
            log('üß™ –¢–µ—Å—Ç 2: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ...');

            try {
                const notification = new Notification('–¢–ï–°–¢ 2: –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ', {
                    body: '–≠—Ç–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –Ω–µ –∏—Å—á–µ–∑–Ω–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!\n–ù–∞–∂–º–∏—Ç–µ –Ω–∞ –Ω–µ–≥–æ —á—Ç–æ–±—ã –∑–∞–∫—Ä—ã—Ç—å.',
                    requireInteraction: true,
                    tag: 'persistent-test'
                });

                log('‚úÖ –ü–æ—Å—Ç–æ—è–Ω–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ (–Ω–µ –∏—Å—á–µ–∑–Ω–µ—Ç —Å–∞–º–æ)');

                notification.onclick = () => {
                    log('üëÜ –ö–ª–∏–∫ –ø–æ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é!');
                    notification.close();
                };

            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ' + error.message);
            }
        }

        function testWithSound() {
            log('üß™ –¢–µ—Å—Ç 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ –∑–≤—É–∫–æ–º...');

            try {
                // –°–æ–∑–¥–∞–µ–º –∞—É–¥–∏–æ —ç–ª–µ–º–µ–Ω—Ç
                const audio = new Audio('data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT');

                const notification = new Notification('–¢–ï–°–¢ 3: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ –∑–≤—É–∫–æ–º', {
                    body: '–î–æ–ª–∂–µ–Ω –±—ã—Ç—å —Å–ª—ã—à–µ–Ω –∑–≤—É–∫!',
                    silent: false,
                    tag: 'sound-test'
                });

                // –í–æ—Å–ø—Ä–æ–∏–∑–≤–æ–¥–∏–º –∑–≤—É–∫
                audio.play().catch(e => {
                    log('‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ—Å—Ç–∏ –∑–≤—É–∫: ' + e.message);
                });

                log('‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ —Å–æ –∑–≤—É–∫–æ–º —Å–æ–∑–¥–∞–Ω–æ');

                notification.onclick = () => {
                    log('üëÜ –ö–ª–∏–∫ –ø–æ –∑–≤—É–∫–æ–≤–æ–º—É —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é!');
                    notification.close();
                };

                setTimeout(() => {
                    notification.close();
                }, 7000);

            } catch (error) {
                log('‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–≤—É–∫–æ–≤–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è: ' + error.message);
            }
        }

        function testMultiple() {
            log('üß™ –¢–µ—Å—Ç 4: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è...');

            for (let i = 1; i <= 3; i++) {
                setTimeout(() => {
                    try {
                        const notification = new Notification(`–¢–ï–°–¢ 4.${i}: –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ${i}`, {
                            body: `–≠—Ç–æ ${i}-–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∏–∑ —Å–µ—Ä–∏–∏`,
                            tag: `multi-test-${i}`,
                            requireInteraction: true
                        });

                        log(`‚úÖ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ ${i} —Å–æ–∑–¥–∞–Ω–æ`);

                        notification.onclick = () => {
                            log(`üëÜ –ö–ª–∏–∫ –ø–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—é ${i}!`);
                            notification.close();
                        };

                    } catch (error) {
                        log(`‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è ${i}: ` + error.message);
                    }
                }, i * 1000);
            }
        }

        function checkSettings() {
            log('üß™ –¢–µ—Å—Ç 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫...');

            log('üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Å–∏—Å—Ç–µ–º–µ:');
            log('- –ë—Ä–∞—É–∑–µ—Ä: ' + navigator.userAgent);
            log('- –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: ' + Notification.permission);
            log('- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Notifications: ' + ('Notification' in window));
            log('- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ ServiceWorker: ' + ('serviceWorker' in navigator));

            if ('Notification' in window) {
                log('- –ú–∞–∫—Å–∏–º—É–º –¥–µ–π—Å—Ç–≤–∏–π: ' + (Notification.maxActions || '–Ω–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ'));
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–∏–¥–∏–º–æ—Å—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—ã
            log('- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤–∏–¥–∏–º–∞: ' + !document.hidden);
            log('- –°–æ—Å—Ç–æ—è–Ω–∏–µ –≤–∏–¥–∏–º–æ—Å—Ç–∏: ' + document.visibilityState);

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ñ–æ–∫—É—Å
            log('- –°—Ç—Ä–∞–Ω–∏—Ü–∞ –≤ —Ñ–æ–∫—É—Å–µ: ' + document.hasFocus());

            log('üí° –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏:');
            log('1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤—ã–π –Ω–∏–∂–Ω–∏–π —É–≥–æ–ª —ç–∫—Ä–∞–Ω–∞');
            log('2. –ù–∞–∂–º–∏—Ç–µ Win + A –¥–ª—è —Ü–µ–Ω—Ç—Ä–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π');
            log('3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Opera: opera://settings/content/notifications');
            log('4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Windows: Win + I ‚Üí –°–∏—Å—Ç–µ–º–∞ ‚Üí –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è');
        }

        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ–º —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        window.onload = function() {
            if (Notification.permission === 'default') {
                Notification.requestPermission().then(permission => {
                    log('–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—É—á–µ–Ω–æ: ' + permission);
                });
            }

            log('üîî –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞. –†–∞–∑—Ä–µ—à–µ–Ω–∏–µ: ' + Notification.permission);
            log('üí° –ù–∞–∂–∏–º–∞–π—Ç–µ –∫–Ω–æ–ø–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π');
        };
    </script>
</body>
</html>

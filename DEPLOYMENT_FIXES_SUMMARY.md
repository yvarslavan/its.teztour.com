# –†–µ–∑—é–º–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è Flask Helpdesk

## üéØ –ü—Ä–æ–±–ª–µ–º—ã –∏ –∏—Ö —Ä–µ—à–µ–Ω–∏—è

### 1. –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–∏—Å–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** –î–∏—Å–∫ 25GB –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ 100% –∏–∑-–∑–∞ 10 –±—ç–∫–∞–ø–æ–≤ (~4.5GB)
**–†–µ—à–µ–Ω–∏–µ:**
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö —Å—Ç–∞—Ä—ã—Ö –±—ç–∫–∞–ø–æ–≤: `sudo rm -rf /var/www/flask_helpdesk_backup_*`
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –±—ç–∫–∞–ø–æ–≤ –≤ CI/CD (—Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –±—ç–∫–∞–ø)
- –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏—Å–∫–∞ –≤ pipeline

### 2. –ü—Ä–æ–±–ª–µ–º—ã —Å –ø—Ä–∞–≤–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
**–ü—Ä–æ–±–ª–µ–º–∞:** `Permission denied` –¥–ª—è flask_session –∏ __pycache__ —Ñ–∞–π–ª–æ–≤
**–†–µ—à–µ–Ω–∏–µ:**
- –°–æ–∑–¥–∞–Ω —Å–∫—Ä–∏–ø—Ç `scripts/server_cleanup.py` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏
- –£–±—Ä–∞–Ω—ã –∫–æ–º–∞–Ω–¥—ã cp/rm –¥–ª—è –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑ CI/CD
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

### 3. –ö–æ–º–∞–Ω–¥—ã sudo –≤ CI/CD
**–ü—Ä–æ–±–ª–µ–º–∞:** `sudo: a terminal is required to read the password`
**–†–µ—à–µ–Ω–∏–µ:**
- –£–±—Ä–∞–Ω—ã –≤—Å–µ sudo –∫–æ–º–∞–Ω–¥—ã –∏–∑ CI/CD pipeline
- –î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—Å–ª–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è
- –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –±–µ–∑ sudo —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫

### 4. SSH –∫–ª—é—á–∏ –≤ after_script
**–ü—Ä–æ–±–ª–µ–º–∞:** `Permission denied (publickey,password)` –≤ after_script
**–†–µ—à–µ–Ω–∏–µ:**
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–≤—Ç–æ—Ä–Ω–∞—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è SSH –∞–≥–µ–Ω—Ç–∞ –≤ after_script
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –æ—Ç–∫–∞—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ SSH –∫–ª—é—á–∞–º–∏

## üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `.gitlab-ci.yml` - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π CI/CD pipeline
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- –£–±—Ä–∞–Ω—ã sudo –∫–æ–º–∞–Ω–¥—ã
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞
- –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Ñ–∞–π–ª–æ–≤
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω after_script —Å SSH
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è —Ä—É—á–Ω—ã—Ö –∫–æ–º–∞–Ω–¥

### 2. `scripts/server_cleanup.py` - –ù–æ–≤—ã–π —Å–∫—Ä–∏–ø—Ç –æ—á–∏—Å—Ç–∫–∏
**–§—É–Ω–∫—Ü–∏–∏:**
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ flask_session
- –û—á–∏—Å—Ç–∫–∞ __pycache__ –∏ .pyc —Ñ–∞–π–ª–æ–≤
- –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞

### 3. `DEPLOYMENT_TROUBLESHOOTING.md` - –ü–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
**–°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ:**
- –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –ø—Ä–æ–±–ª–µ–º
- –ü–æ—à–∞–≥–æ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è
- –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏–µ

### 4. `URGENT_FIX.md` - –°—Ä–æ—á–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:**
- –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Ä–µ—à–µ–Ω–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–±–ª–µ–º
- –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ –¥–∏—Å–∫–∞
- –ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üîß –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ (–Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ):
```bash
# 1. –û—á–∏—Å—Ç–∫–∞ –¥–∏—Å–∫–∞
sudo rm -rf /var/www/flask_helpdesk_backup_*
rm -rf /tmp/flask*

# 2. –û—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
cd /var/www/flask_helpdesk
python3 scripts/server_cleanup.py

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
df -h
```

### –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ CI/CD:
1. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ —Å–≤–æ–±–æ–¥–Ω–æ >2GB –º–µ—Å—Ç–∞
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å deploy job –≤ GitLab
3. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
```bash
sudo systemctl restart flask-helpdesk
sudo chown -R www-data:www-data /var/www/flask_helpdesk/flask_session
sudo chown -R www-data:www-data /var/www/flask_helpdesk/logs
```

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚ùå –î–∏—Å–∫ –∑–∞–ø–æ–ª–Ω–µ–Ω –Ω–∞ 100%
- ‚ùå CI/CD –ø–∞–¥–∞–µ—Ç —Å Permission denied
- ‚ùå sudo –∫–æ–º–∞–Ω–¥—ã –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚ùå after_script –Ω–µ –º–æ–∂–µ—Ç –ø–æ–¥–∫–ª—é—á–∏—Ç—å—Å—è –ø–æ SSH

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π:
- ‚úÖ –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–æ ~4.5GB –º–µ—Å—Ç–∞ –Ω–∞ –¥–∏—Å–∫–µ
- ‚úÖ CI/CD —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ sudo
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–æ–±–ª–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –æ—Ç–∫–∞—Ç –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∏—Å–∫–∞

## üîç –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∏—Å–∫–∞
df -h | grep -E "(Filesystem|/dev/mapper)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
python3 scripts/server_cleanup.py check

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl status flask-helpdesk
```

### –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è:
```bash
# –î–æ–±–∞–≤–∏—Ç—å –≤ cron –µ–∂–µ–Ω–µ–¥–µ–ª—å–Ω—É—é –æ—á–∏—Å—Ç–∫—É
0 2 * * 0 cd /var/www/flask_helpdesk && python3 scripts/server_cleanup.py
```

## üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã

### –ü—Ä–∏ –ø–æ–ª–Ω–æ–º —Å–±–æ–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è:
```bash
# –û—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl stop flask-helpdesk

# –û—Ç–∫–∞—Ç –∫ –±—ç–∫–∞–ø—É (–µ—Å–ª–∏ –µ—Å—Ç—å)
cd /var/www
sudo mv flask_helpdesk flask_helpdesk_broken
sudo mv flask_helpdesk_backup flask_helpdesk

# –ó–∞–ø—É—Å–∫ —Å–µ—Ä–≤–∏—Å–∞
sudo systemctl start flask-helpdesk
```

### –ü—Ä–∏ –ø–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–∏—Å–∫–∞:
```bash
# –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
sudo rm -rf /var/www/flask_helpdesk_backup_*
sudo rm -rf /tmp/*
sudo journalctl --vacuum-time=7d
```

## üìà –£–ª—É—á—à–µ–Ω–∏—è –¥–ª—è –±—É–¥—É—â–µ–≥–æ

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–∏—Å–∫–∞** - –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã –ø—Ä–∏ –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–∏ >80%
2. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–æ—Ç–∞—Ü–∏—è –±—ç–∫–∞–ø–æ–≤** - —Ö—Ä–∞–Ω–∏—Ç—å —Ç–æ–ª—å–∫–æ 1-2 –ø–æ—Å–ª–µ–¥–Ω–∏—Ö
3. **–õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è** - –¥–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –≤—Å–µ—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
4. **–ü—Ä–æ–≤–µ—Ä–∫–∏ –ø–µ—Ä–µ–¥ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ–º** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –æ–∫—Ä—É–∂–µ–Ω–∏—è

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `URGENT_FIX.md` –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π
2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `DEPLOYMENT_TROUBLESHOOTING.md` –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
3. –ó–∞–ø—É—Å—Ç–∏—Ç—å `python3 scripts/server_cleanup.py check`
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `sudo journalctl -u flask-helpdesk -f`

---
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Ä–µ—à–µ–Ω—ã
**–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ –ø—Ä–æ–¥–∞–∫—à–Ω—É:** ‚úÖ –î–∞, –ø–æ—Å–ª–µ –æ—á–∏—Å—Ç–∫–∏ –¥–∏—Å–∫–∞
**–í—Ä–µ–º—è –≤–Ω–µ–¥—Ä–µ–Ω–∏—è:** ~10 –º–∏–Ω—É—Ç –¥–ª—è –æ—á–∏—Å—Ç–∫–∏ + –≤—Ä–µ–º—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è

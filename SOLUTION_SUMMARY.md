# โ ะะตัะตะฝะธะต ะฟัะพะฑะปะตะผั ะฟะพะดะบะปััะตะฝะธั ะบ MySQL ะฒ WSL

## ะัะพะฑะปะตะผะฐ

ะัะธ ัะฐะฑะพัะต ะฒ WSL ั Cisco Secure Client ะฒะพะทะฝะธะบะฐะปะฐ ะพัะธะฑะบะฐ:
```
(2013, 'Lost connection to MySQL server during query')
```

## ะัะธัะธะฝะฐ

ะคะฐะนะป `.env` (ะธ `.env.development`) ะฝะฐัััะพะตะฝ ะฝะฐ ะธัะฟะพะปัะทะพะฒะฐะฝะธะต `127.0.0.1` ะดะปั ะฟะพะดะบะปััะตะฝะธั ะบ MySQL ัะตัะตะท ะฟะพัั-ะฟัะพะบัะธ Windows. ะะพ ะฟะพัั-ะฟัะพะบัะธ Windows (`netsh portproxy`) ะฝะต ัะฐะฑะพัะฐะตั ะธะท WSL โ ั WSL ัะฒะพะน ัะตัะตะฒะพะน ััะตะบ.

## ะะตัะตะฝะธะต

ะัะฟะพะปัะทะพะฒะฐัั **ะฟััะผะพะต ะฟะพะดะบะปััะตะฝะธะต** ะบ MySQL ัะตัะฒะตัะฐะผ ัะตัะตะท VPN:
- `MYSQL_HOST=helpdesk.teztour.com` ะฒะผะตััะพ `127.0.0.1`
- `MYSQL_QUALITY_HOST=quality.teztour.com` ะฒะผะตััะพ `127.0.0.1:3307`

## ะัะธะผะตะฝะตะฝะธะต ะธัะฟัะฐะฒะปะตะฝะธั

### ะะฐัะธะฐะฝั 1: ะะฒัะพะผะฐัะธัะตัะบะธะน (ัะตะบะพะผะตะฝะดัะตััั)

```bash
# ะะดะธะฝ ัะฐะท: ะฝะฐัััะพะธัั ะผะตััะธะบั WSL ะฒ Windows PowerShell (ะพั ะฐะดะผะธะฝะธัััะฐัะพัะฐ)
Get-NetIPInterface | Where-Object {$_.InterfaceAlias -Match "vEthernet (WSL)"} | Set-NetIPInterface -InterfaceMetric 6000

# ะ WSL: ะฟัะธะผะตะฝะธัั ะธัะฟัะฐะฒะปะตะฝะธะต
bash APPLY_FIX.sh
```

### ะะฐัะธะฐะฝั 2: ะััะฝะพะน

```bash
# ะกะพะทะดะฐัั ะบะพะฝัะธะณััะฐัะธั
python3 setup_wsl_config.py

# ะะฐะฟัััะธัั ะฟัะธะปะพะถะตะฝะธะต
python3 app.py
```

## ะัะพะฒะตัะบะฐ

ะะพัะปะต ะฟัะธะผะตะฝะตะฝะธั ะธัะฟัะฐะฒะปะตะฝะธั:

```bash
# 1. ะัะพะฒะตัะธัั ะบะพะฝัะธะณััะฐัะธั
grep -E "MYSQL.*HOST" .env

# ะะพะปะถะฝะพ ะฑััั:
# MYSQL_HOST=helpdesk.teztour.com
# MYSQL_QUALITY_HOST=quality.teztour.com

# 2. ะัะพะฒะตัะธัั ะดะพัััะฟะฝะพััั ัะตัะฒะตัะพะฒ
ping -c 3 helpdesk.teztour.com
nc -zv helpdesk.teztour.com 3306

# 3. ะะฐะฟัััะธัั ะฟัะธะปะพะถะตะฝะธะต
python3 app.py
```

## ะงัะพ ะฑัะปะพ ัะพะทะดะฐะฝะพ

1. **setup_wsl_config.py** - ัะบัะธะฟั ะดะปั ัะพะทะดะฐะฝะธั ะฟัะฐะฒะธะปัะฝะพะณะพ `.env` ัะฐะนะปะฐ
2. **WSL_VPN_SETUP.md** - ะฟะพะดัะพะฑะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฟะพ ะฝะฐัััะพะนะบะต WSL ั VPN
3. **QUICK_START_WSL.md** - ะบัะฐัะบะฐั ะธะฝััััะบัะธั ะดะปั ะฑััััะพะณะพ ััะฐััะฐ
4. **APPLY_FIX.sh** - ะฐะฒัะพะผะฐัะธัะตัะบะธะน ัะบัะธะฟั ะฟัะธะผะตะฝะตะฝะธั ะธัะฟัะฐะฒะปะตะฝะธะน
5. **README.md** - ะพะฑะฝะพะฒะปัะฝะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฟัะพะตะบัะฐ
6. **ENV_SETUP.md** - ะพะฑะฝะพะฒะปัะฝะฝะฐั ะดะพะบัะผะตะฝัะฐัะธั ั ะธะฝัะพัะผะฐัะธะตะน ะพ WSL
7. **app.py** - ะธัะฟัะฐะฒะปะตะฝะฐ ะปะพะณะธะบะฐ ะฒัะฑะพัะฐ ะบะพะฝัะธะณััะฐัะธะธ (ะฐะฒัะพะผะฐัะธัะตัะบะพะต ะพะฟัะตะดะตะปะตะฝะธะต WSL)

## ะขะตัะฝะธัะตัะบะธะต ะดะตัะฐะปะธ

### ะกะตัะตะฒะฐั ะฐััะธัะตะบัััะฐ

```
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
โ Windows                                       โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ Cisco Secure Client (VPN)                 โ โ
โ โ โ                                         โ โ
โ โ VPN ััะฝะฝะตะปั โ helpdesk.teztour.com       โ โ
โ โ                quality.teztour.com       โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ          โ (ัะตัะตะท ะผะตััะธะบั 6000)              โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โ โ WSL (Linux)                               โ โ
โ โ โ                                         โ โ
โ โ Python ะฟัะธะปะพะถะตะฝะธะต โ MySQL (ัะตัะตะท VPN)    โ โ
โ โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ โ
โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
```

### ะะตััะธะบะฐ ัะตัะตะฒะพะณะพ ะธะฝัะตััะตะนัะฐ

ะะพะผะฐะฝะดะฐ `Set-NetIPInterface -InterfaceMetric 6000` ะธะทะผะตะฝัะตั ะฟัะธะพัะธัะตั ะผะฐัััััะธะทะฐัะธะธ ะดะปั WSL:
- ะะธะทะบะฐั ะผะตััะธะบะฐ (6000) = ะฝะธะทะบะธะน ะฟัะธะพัะธัะตั
- ะญัะพ ะฟะพะทะฒะพะปัะตั WSL ะธัะฟะพะปัะทะพะฒะฐัั VPN-ะผะฐัััััั Windows
- ะะฐัััะพะนะบะฐ ัะพััะฐะฝัะตััั ะผะตะถะดั ะฟะตัะตะทะฐะณััะทะบะฐะผะธ

### ะะฐะทะปะธัะธั ะบะพะฝัะธะณััะฐัะธะน

| ะะฐัะฐะผะตัั | .env.development | .env.production | .env (WSL) |
|----------|-----------------|-----------------|------------|
| MYSQL_HOST | 127.0.0.1 | helpdesk.teztour.com | helpdesk.teztour.com |
| MYSQL_QUALITY_HOST | 127.0.0.1:3307 | quality.teztour.com | quality.teztour.com |
| ะะพัั-ะฟัะพะบัะธ | ะขัะตะฑัะตััั | ะะต ััะตะฑัะตััั | ะะต ััะตะฑัะตััั |
| VPN | ะขัะตะฑัะตััั | ะขัะตะฑัะตััั | ะขัะตะฑัะตััั |
| ะะตััะธะบะฐ WSL | N/A | N/A | ะขัะตะฑัะตััั (6000) |

## ะัะบะฐั ะธะทะผะตะฝะตะฝะธะน

ะัะปะธ ััะพ-ัะพ ะฟะพัะปะพ ะฝะต ัะฐะบ:

```bash
# ะะพัััะฐะฝะพะฒะธัั ััะฐััั ะบะพะฝัะธะณััะฐัะธั
cp .env.backup .env

# ะะปะธ ะฟะตัะตัะพะทะดะฐัั
python3 setup_env.py development  # ะดะปั Windows
# ะธะปะธ
python3 setup_env.py production   # ะดะปั production
```

## ะะฐะปัะฝะตะนัะธะต ะดะตะนััะฒะธั

ะะพัะปะต ััะฟะตัะฝะพะณะพ ะฟัะธะผะตะฝะตะฝะธั ะธัะฟัะฐะฒะปะตะฝะธั:

1. โ ะะพะฝัะธะณััะฐัะธั ัะพะทะดะฐะฝะฐ
2. โ VPN ัะฐะฑะพัะฐะตั ะฒ WSL
3. โ MySQL ัะตัะฒะตัั ะดะพัััะฟะฝั
4. ๐ ะะฐะฟัััะธัะต ะฟัะธะปะพะถะตะฝะธะต: `python3 app.py`

## ะะพะบัะผะตะฝัะฐัะธั

- ๐ [WSL_VPN_SETUP.md](WSL_VPN_SETUP.md) - ะะพะดัะพะฑะฝะพะต ััะบะพะฒะพะดััะฒะพ
- ๐ [QUICK_START_WSL.md](QUICK_START_WSL.md) - ะัััััะน ััะฐัั
- ๐ [ENV_SETUP.md](ENV_SETUP.md) - ะะฐัััะพะนะบะฐ ะพะบััะถะตะฝะธะน
- ๐ [README.md](README.md) - ะะฑัะฐั ะดะพะบัะผะตะฝัะฐัะธั ะฟัะพะตะบัะฐ

## ะะพะดะดะตัะถะบะฐ

ะัะปะธ ะฒะพะทะฝะธะบะปะธ ะฟัะพะฑะปะตะผั:

1. ะัะพะฒะตัััะต ััะพ VPN ะฟะพะดะบะปััะตะฝ: `ping vpn.teztour.com`
2. ะัะพะฒะตัััะต ะผะตััะธะบั WSL: ัะผ. WSL_VPN_SETUP.md
3. ะัะพะฒะตัััะต ะดะพัััะฟะฝะพััั ัะตัะฒะตัะพะฒ: `ping helpdesk.teztour.com`
4. ะัะพะฒะตัััะต ะบะพะฝัะธะณััะฐัะธั: `grep MYSQL .env`


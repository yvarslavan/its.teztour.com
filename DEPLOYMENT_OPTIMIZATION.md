# üóúÔ∏è –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞–∑–º–µ—Ä–∞ Deployment –ø–∞–∫–µ—Ç–∞

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ CI/CD pipeline –≤–æ–∑–Ω–∏–∫–∞–ª–∞ –æ—à–∏–±–∫–∞:
```
ERROR: Uploading artifacts as "archive" to coordinator... 413 Request Entity Too Large
```

–†–∞–∑–º–µ—Ä deployment –ø–∞–∫–µ—Ç–∞ —Å–æ—Å—Ç–∞–≤–ª—è–ª **127MB**, —á—Ç–æ –ø—Ä–µ–≤—ã—à–∞–ª–æ –ª–∏–º–∏—Ç GitLab –¥–ª—è –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–æ–≤.

## –†–µ—à–µ–Ω–∏–µ

### ‚ö†Ô∏è –†–ê–î–ò–ö–ê–õ–¨–ù–û–ï –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï (v2)
–ü–æ—Å–ª–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —á—Ç–æ –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ - —Ñ–∞–π–ª `app_err.log` —Ä–∞–∑–º–µ—Ä–æ–º **68MB**, –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫–∞—Ä–¥–∏–Ω–∞–ª—å–Ω–æ –Ω–æ–≤–∞—è —Å—Ç—Ä–∞—Ç–µ–≥–∏—è:

**–ù–û–í–´–ô –ü–û–î–•–û–î**: –í–∫–ª—é—á–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö —Ñ–∞–π–ª–æ–≤ –≤–º–µ—Å—Ç–æ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –Ω–µ–Ω—É–∂–Ω—ã—Ö.

### 1. ~~–†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤~~ (–£–°–¢–ê–†–ï–õ–û)
~~–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∏—Å–∫–ª—é—á–µ–Ω–∏—è –≤ `rsync` –¥–ª—è —É–º–µ–Ω—å—à–µ–Ω–∏—è —Ä–∞–∑–º–µ—Ä–∞ –ø–∞–∫–µ—Ç–∞:~~

### 1. –ù–û–í–ê–Ø –°–¢–†–ê–¢–ï–ì–ò–Ø: –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä —Ñ–∞–π–ª–æ–≤
–ö–æ–ø–∏—Ä—É—é—Ç—Å—è –¢–û–õ–¨–ö–û –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Ñ–∞–π–ª—ã:

```bash
# –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ–∞–π–ª—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
app.py, wsgi.py, requirements.txt, flask-helpdesk.service
config.py, .flaskenv, config.ini
mysql_db.py, redmine.py, erp_oracle.py

# –ü–∞–ø–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–±–µ–∑ –∫—ç—à–∞)
blog/ (–∏—Å–∫–ª—é—á–∞—è __pycache__ –∏ *.pyc)
```

**–ò—Å–∫–ª—é—á–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é**:
- `app_err.log` (68MB) - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞
- –í—Å–µ `*.log` —Ñ–∞–π–ª—ã
- –ü–∞–ø–∫–∏: `venv/`, `scripts/`, `migrations/`, `.git/`, `logs/`
- –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: `*.md`, `*.sh`
- –ö—ç—à –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –ø–∞–∫–µ—Ç–∞ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞:
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö `*.pyc` —Ñ–∞–π–ª–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö `__pycache__` –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π
- –£–¥–∞–ª–µ–Ω–∏–µ log —Ñ–∞–π–ª–æ–≤
- –£–¥–∞–ª–µ–Ω–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ (`.DS_Store`)

### 3. –°–∂–∞—Ç–∏–µ –∞—Ä—Ö–∏–≤–∞
–°–æ–∑–¥–∞–µ—Ç—Å—è —Å–∂–∞—Ç—ã–π `tar.gz` –∞—Ä—Ö–∏–≤ –¥–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π —ç–∫–æ–Ω–æ–º–∏–∏ –º–µ—Å—Ç–∞:
```bash
tar -czf deployment_package.tar.gz -C deployment_package .
```

### 4. –£–º–Ω—ã–π –¥–µ–ø–ª–æ–π
–î–µ–ø–ª–æ–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–± –ø–µ—Ä–µ–¥–∞—á–∏:
- –ï—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω —Å–∂–∞—Ç—ã–π –∞—Ä—Ö–∏–≤ - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –µ–≥–æ
- –ò–Ω–∞—á–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –æ–±—ã—á–Ω—É—é `rsync` —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é

## –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –î–æ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏:
- –†–∞–∑–º–µ—Ä: **127MB**
- –°—Ç–∞—Ç—É—Å: ‚ùå –ü—Ä–µ–≤—ã—à–µ–Ω–∏–µ –ª–∏–º–∏—Ç–∞

### –ü–æ—Å–ª–µ –†–ê–î–ò–ö–ê–õ–¨–ù–û–ô –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (v2):
- –û–∂–∏–¥–∞–µ–º—ã–π —Ä–∞–∑–º–µ—Ä: **< 20MB** (—Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —Ñ–∞–π–ª—ã)
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∂–∞—Ç–∏—è: **~70-80%**
- –°—Ç–∞—Ç—É—Å: ‚úÖ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö –ª–∏–º–∏—Ç–∞
- –ò—Å–∫–ª—é—á–µ–Ω: `app_err.log` (68MB) - –æ—Å–Ω–æ–≤–Ω–∞—è –ø—Ä–∏—á–∏–Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

–í –ª–æ–≥–∞—Ö CI/CD —Ç–µ–ø–µ—Ä—å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è:
- –†–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞ –¥–æ —Å–∂–∞—Ç–∏—è
- –†–∞–∑–º–µ—Ä —Å–∂–∞—Ç–æ–≥–æ –∞—Ä—Ö–∏–≤–∞
- –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç —Å–∂–∞—Ç–∏—è
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ñ–∞–π–ª–æ–≤ –≤ –ø–∞–∫–µ—Ç–µ

## –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

–°–ª–µ–¥—É—é—â–∏–µ –∫–æ–º–∞–Ω–¥—ã –ø–æ–º–æ–≥—É—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å —Ä–∞–∑–º–µ—Ä –ø–∞–∫–µ—Ç–∞:
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –ª–æ–∫–∞–ª—å–Ω–æ
du -sh deployment_package/
ls -lh deployment_package.tar.gz

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ CI/CD –ª–æ–≥–∞—Ö
grep -E "(–†–∞–∑–º–µ—Ä|Size|–ú–ë|MB)" ci_logs.txt
```

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ (–ø—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

–ï—Å–ª–∏ —Ä–∞–∑–º–µ—Ä –≤—Å–µ –µ—â–µ –ø—Ä–µ–≤—ã—à–∞–µ—Ç –ª–∏–º–∏—Ç—ã:

1. **–ò—Å–∫–ª—é—á–∏—Ç—å —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã**:
   ```bash
   --exclude='blog/static/js/vendor/'
   --exclude='blog/static/css/vendor/'
   ```

2. **–ú–∏–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è JS/CSS**:
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–∏
   - –£–¥–∞–ª–∏—Ç—å source maps

3. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–∞–∫–µ—Ç–∞**:
   - –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–µ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
   - –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –º–Ω–æ–≥–æ—ç—Ç–∞–ø–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è

---
*–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 25.12.2024*
*–°—Ç–∞—Ç—É—Å: ‚úÖ –ê–∫—Ç–∏–≤–Ω–æ*

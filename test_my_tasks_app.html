<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test MyTasksApp</title>

    <!-- DataTables CSS -->
    <link rel="stylesheet" type="text/css" href="http://localhost:5000/static/css/dataTables.bootstrap4.min.css">
    <link rel="stylesheet" type="text/css" href="http://localhost:5000/static/css/responsive.bootstrap4.min.css">

    <!-- –ö–∞—Å—Ç–æ–º–Ω—ã–µ CSS -->
    <link rel="stylesheet" href="http://localhost:5000/static/css/my_tasks_modern_ui.css">
    <link rel="stylesheet" href="http://localhost:5000/static/css/tasks_modern_ui.css">
    <link rel="stylesheet" href="http://localhost:5000/static/css/status_accordion.css">
    <link rel="stylesheet" href="http://localhost:5000/static/css/modern-status-indicators.css">
    <link rel="stylesheet" href="http://localhost:5000/static/css/tasks_enhanced.css">
    <link rel="stylesheet" href="http://localhost:5000/static/css/tasks_table_header_redesign.css">
    <link rel="stylesheet" href="http://localhost:5000/static/css/pages/tasks/tasks.css">

    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test-info { background: #f0f8ff; padding: 15px; margin: 10px 0; border-radius: 5px; }
        .error { background: #ffe6e6; color: #cc0000; }
        .success { background: #e6ffe6; color: #006600; }
        .loading-spinner { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 9999; }
        .loading-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: white; padding: 20px; border-radius: 10px; text-align: center; }
    </style>
</head>
<body>
    <div class="test-info">
        <h2>üß™ –¢–µ—Å—Ç MyTasksApp</h2>
        <p>–≠—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ JavaScript –∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ MyTasksApp –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.</p>
        <div id="test-results"></div>
    </div>

    <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–ø–∏–Ω–Ω–µ—Ä –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loading-spinner" class="loading-spinner">
        <div class="loading-content">
            <div class="spinner-icon">
                <i class="fas fa-rocket fa-bounce"></i>
            </div>
            <h3>üöÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∑–∞–¥–∞—á–∞–º–∏...</h3>
            <p id="loading-message">–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Kanban –¥–æ—Å–∫–∏ –∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Redmine API</p>
        </div>
    </div>

    <!-- –ü–∞–Ω–µ–ª—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ (Status Breakdown Dashboard) -->
    <section class="status-breakdown-dashboard">
        <div class="status-breakdown-grid">
            <div class="status-card" data-type="total">
                <div class="card-header">
                    <div class="card-icon total">
                        <i class="fas fa-tasks"></i>
                    </div>
                    <div class="card-title">
                        <h3>–í—Å–µ–≥–æ –∑–∞–¥–∞—á</h3>
                        <span class="card-value" id="total-tasks">-</span>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- –¢–∞–±–ª–∏—Ü–∞ –∑–∞–¥–∞—á -->
    <div class="table-container">
        <table id="tasksTable" class="display modern-datatable-redesigned">
            <thead>
                <tr>
                    <th>ID</th>
                    <th>Email</th>
                    <th>–¢–µ–º–∞ –∑–∞–¥–∞—á–∏</th>
                    <th>–°—Ç–∞—Ç—É—Å</th>
                    <th>–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç</th>
                    <th>–°–æ–∑–¥–∞–Ω–∞</th>
                    <th>–û–±–Ω–æ–≤–ª–µ–Ω–∞</th>
                </tr>
            </thead>
            <tbody>
                <!-- –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </tbody>
        </table>
    </div>

    <!-- JavaScript -->
    <script src="http://localhost:5000/static/js/jquery-3.5.1.min.js"></script>
    <script src="http://localhost:5000/static/js/jquery.dataTables.min.js"></script>
    <script src="http://localhost:5000/static/js/dataTables.bootstrap4.min.js"></script>
    <script src="http://localhost:5000/static/js/dataTables.responsive.min.js"></script>
    <script src="http://localhost:5000/static/js/responsive.bootstrap4.min.js"></script>

    <!-- Font Awesome –¥–ª—è –∏–∫–æ–Ω–æ–∫ -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <!-- MyTasksApp -->
    <script src="http://localhost:5000/static/js/my_tasks_app.js"></script>

    <script>
        // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –≤—ã–≤–æ–¥–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Ç–µ—Å—Ç–∞
        function logTest(message, type = 'info') {
            const results = document.getElementById('test-results');
            const div = document.createElement('div');
            div.className = type;
            div.innerHTML = `<strong>${new Date().toLocaleTimeString()}</strong>: ${message}`;
            results.appendChild(div);
            console.log(`[${type.toUpperCase()}] ${message}`);
        }

        // –¢–µ—Å—Ç–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ API
        window.testAPI = function() {
            logTest('API endpoints –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏, –Ω–æ JavaScript –∑–∞–≥—Ä—É–∂–µ–Ω –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ', 'success');

            // –°–∫—Ä—ã–≤–∞–µ–º —Å–ø–∏–Ω–Ω–µ—Ä
            document.getElementById('loading-spinner').style.display = 'none';

            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
            document.getElementById('total-tasks').textContent = '0';
        };

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ DOM
        $(document).ready(function() {
            logTest('DOM –∑–∞–≥—Ä—É–∂–µ–Ω, –Ω–∞—á–∏–Ω–∞–µ–º —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ...', 'info');

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É jQuery
            if (typeof $ !== 'undefined') {
                logTest('‚úÖ jQuery –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            } else {
                logTest('‚ùå jQuery –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω', 'error');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É DataTables
            if (typeof $.fn.DataTable !== 'undefined') {
                logTest('‚úÖ DataTables –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');
            } else {
                logTest('‚ùå DataTables –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω', 'error');
                return;
            }

            // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–≥—Ä—É–∑–∫—É MyTasksApp
            if (typeof MyTasksApp !== 'undefined') {
                logTest('‚úÖ MyTasksApp –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ', 'success');

                // –ü—ã—Ç–∞–µ–º—Å—è –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å —Å –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫
                try {
                    // –ü–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª—è–µ–º API endpoints –¥–ª—è —Ç–µ—Å—Ç–∞
                    MyTasksApp.config.apiEndpoints = {
                        tasks: '/test-api-tasks',
                        statistics: '/test-api-statistics',
                        filters: '/test-api-filters'
                    };

                    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
                    MyTasksApp.init();
                    logTest('‚úÖ MyTasksApp –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω —É—Å–ø–µ—à–Ω–æ', 'success');

                    // –í—ã–∑—ã–≤–∞–µ–º —Ç–µ—Å—Ç–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                    setTimeout(testAPI, 2000);

                } catch (error) {
                    logTest(`‚ùå –û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ MyTasksApp: ${error.message}`, 'error');
                }
            } else {
                logTest('‚ùå MyTasksApp –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω', 'error');
            }
        });
    </script>
</body>
</html>

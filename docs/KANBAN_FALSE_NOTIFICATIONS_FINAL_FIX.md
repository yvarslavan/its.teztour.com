# –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∂–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –≤ Kanban Drag & Drop

## –ü—Ä–æ–±–ª–µ–º–∞
–ü—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∑–∞–¥–∞—á—É –≤ —Ç—É –∂–µ –∫–æ–ª–æ–Ω–∫—É –ø–æ—è–≤–ª—è–ª–∏—Å—å –ª–æ–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:
1. ‚ùå "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞..."
2. ‚ùå "–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ #176275 –æ–±–Ω–æ–≤–ª—ë–Ω"
3. ‚úÖ "–ó–∞–¥–∞—á–∞ #176275 —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ" (–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ)

## –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. –ì–õ–ê–í–ù–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: –î—É–±–ª–∏—Ä—É—é—â–∏–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
**–ü—Ä–æ–±–ª–µ–º–∞**: –í –∫–æ–¥–µ –±—ã–ª–æ **–î–í–ê –†–ê–ó–ù–´–•** –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ `drop`:
1. **–°—Ç—Ä–æ–∫–∞ 922** - —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –≤ –º–µ—Ç–æ–¥–µ —Å–æ–∑–¥–∞–Ω–∏—è –∫–∞—Ä—Ç–æ—á–µ–∫, –∫–æ—Ç–æ—Ä—ã–π **–≤—Å–µ–≥–¥–∞ –≤—ã–∑—ã–≤–∞–ª** `updateTaskStatus` –±–µ–∑ –ø—Ä–æ–≤–µ—Ä–æ–∫
2. **–°—Ç—Ä–æ–∫–∞ 1765** - –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ `handleDrop` —Å –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏

–°—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Ä–∞–±–æ—Ç–∞—Ç—å –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–ª –∑–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä, –¥–∞–∂–µ –∫–æ–≥–¥–∞ –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ—Ç–º–µ–Ω—è–ª –æ–ø–µ—Ä–∞—Ü–∏—é.

**–ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ**: –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ç–∞–∫–∞—è –∂–µ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤ –≤ —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫:
```javascript
zone.addEventListener('drop', (e) => {
    // ... –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

    // –í–ê–ñ–ù–û: –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ–≤–µ—Ä–∫—É —Å—Ç–∞—Ç—É—Å–∞ –∏ –≤ —Å—Ç–∞—Ä—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫
    const taskCard = document.querySelector(`[data-task-id="${taskId}"]`);
    if (taskCard) {
        const currentColumn = taskCard.closest('[data-status-id]');
        const currentStatusId = currentColumn ? currentColumn.getAttribute('data-status-id') : null;

        if (String(currentStatusId) === String(statusId)) {
            console.log('–°–¢–ê–†–´–ô –û–ë–†–ê–ë–û–¢–ß–ò–ö: –°—Ç–∞—Ç—É—Å—ã –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ, –ù–ï –≤—ã–∑—ã–≤–∞–µ–º updateTaskStatus');
            return; // –ù–ï –≤—ã–∑—ã–≤–∞–µ–º updateTaskStatus
        }
    }

    // –í—ã–∑—ã–≤–∞–µ–º updateTaskStatus —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ —Å—Ç–∞—Ç—É—Å—ã —Ä–∞–∑–Ω—ã–µ
    if (window.kanbanManager && window.kanbanManager.updateTaskStatus) {
        window.kanbanManager.updateTaskStatus(taskId, statusId);
    }
});
```

### 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è
**–î–æ–±–∞–≤–ª–µ–Ω—ã –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞—â–∏—Ç—ã**:
- –≠–∫—Å–ø—Ä–µ—Å—Å-–ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –Ω–∞—á–∞–ª–µ `handleDrop`
- –î—É–±–ª–∏—Ä—É—é—â–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –º–µ—Ç–æ–¥–µ `updateTaskStatus`
- –ó–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤ —Å —Ñ–ª–∞–≥–æ–º `_isProcessingDrop`
- –ü–æ–¥—Ä–æ–±–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

## –ö–ª—é—á–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### 1. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤
```javascript
if (finalTaskCard) {
    const currentColumn = finalTaskCard.closest('[data-status-id]');
    const currentStatusId = currentColumn ? currentColumn.getAttribute('data-status-id') : null;

    // –ü—Ä–∏–≤–æ–¥–∏–º —Å—Ç–∞—Ç—É—Å—ã –∫ —Å—Ç—Ä–æ–∫–∞–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
    const currentStatusStr = String(currentStatusId);
    const newStatusStr = String(newStatusId);

    if (currentStatusStr === newStatusStr) {
        console.log('[KanbanManager] ‚ö†Ô∏è –°–¢–ê–¢–£–°–´ –û–î–ò–ù–ê–ö–û–í–´–ï - –æ—Ç–º–µ–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é');

        // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–∞–µ–º –≤—Å–µ drag-—Å–æ—Å—Ç–æ—è–Ω–∏—è
        this.clearAllDragStates();

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        this.showNotification(`–ó–∞–¥–∞—á–∞ #${taskId} —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ`, 'info');

        // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥ –∏ –∑–∞–≤–µ—Ä—à–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
        this._isProcessingDrop = false;
        return; // ‚Üê –ó–î–ï–°–¨ –§–£–ù–ö–¶–ò–Ø –î–û–õ–ñ–ù–ê –ó–ê–í–ï–†–®–ò–¢–¨–°–Ø
    }
}
```

### 2. –î–æ–±–∞–≤–ª–µ–Ω–∞ –∑–∞—â–∏—Ç–∞ –æ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –≤—ã–∑–æ–≤–æ–≤
```javascript
// –í –Ω–∞—á–∞–ª–µ handleDrop
if (this._isProcessingDrop) {
    return; // –ò–≥–Ω–æ—Ä–∏—Ä—É–µ–º –ø–æ–≤—Ç–æ—Ä–Ω—ã–π –≤—ã–∑–æ–≤
}
this._isProcessingDrop = true;

// –í finally –±–ª–æ–∫–µ
finally {
    this._isProcessingDrop = false; // –í—Å–µ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º —Ñ–ª–∞–≥
}
```

### 3. –£–ª—É—á—à–µ–Ω–Ω—ã–π –ø–æ–∏—Å–∫ –∫–∞—Ä—Ç–æ—á–µ–∫
```javascript
// –ò—â–µ–º –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Å –¥–∞–Ω–Ω—ã–º ID
const allTaskCards = document.querySelectorAll(`[data-task-id="${taskId}"]`);

// –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –∏—â–µ–º –∫–∞—Ä—Ç–æ—á–∫—É —Å –∫–ª–∞—Å—Å–æ–º dragging
const draggingCard = document.querySelector('.kanban-card.dragging');

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â—É—é –∫–∞—Ä—Ç–æ—á–∫—É
const finalTaskCard = (draggingCard && draggingCard.getAttribute('data-task-id') === taskId)
    ? draggingCard
    : allTaskCards[0];
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç
–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∑–∞–¥–∞—á—É –≤ —Ç—É –∂–µ –∫–æ–ª–æ–Ω–∫—É:

‚úÖ **–ü–æ—è–≤–ª—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –æ–¥–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ**: "–ó–∞–¥–∞—á–∞ #176275 —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ"

‚ùå **–ù–ï –ø–æ—è–≤–ª—è—é—Ç—Å—è –ª–æ–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**:
- "–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞..."
- "–°—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏ –æ–±–Ω–æ–≤–ª—ë–Ω"

‚úÖ **–ö—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–µ—Ç**

‚úÖ **–ó–∞–ø—Ä–æ—Å –Ω–∞ —Å–µ—Ä–≤–µ—Ä –ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è**

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã

### –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ –¥–æ—Å—Ç—É–ø–Ω—ã:
```javascript
// –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
window.debugKanbanCards();

// –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ drag-—Å–æ—Å—Ç–æ—è–Ω–∏–π
window.emergencyDragCleanup();
```

### –û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ:
```
[KanbanManager] üîç –ü–æ–∏—Å–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞—á–∏ —Å ID: 176275
[KanbanManager] üîç –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫ —Å ID 176275 : 1
[KanbanManager] üìã –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏: 2 (—Ç–∏–ø: string)
[KanbanManager] üìã –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: 2 (—Ç–∏–ø: string)
[KanbanManager] üìã –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ (—Å—Ç—Ä–æ–∫–∏): {currentStatusStr: "2", newStatusStr: "2", —Ä–∞–≤–Ω—ã: true}
[KanbanManager] ‚ö†Ô∏è –°–¢–ê–¢–£–°–´ –û–î–ò–ù–ê–ö–û–í–´–ï - –æ—Ç–º–µ–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é
[KanbanManager] ‚ö†Ô∏è RETURN - —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–¥–µ—Å—å
```

## –§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã
- **`blog/static/js/pages/tasks/components/KanbanManager.js`** - –æ—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞
- **`blog/static/css/pages/tasks/tasks.css`** - —Å—Ç–∏–ª–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ `/tasks/my-tasks` –≤ —Ä–µ–∂–∏–º–µ Kanban
2. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
3. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∑–∞–¥–∞—á—É –≤ —Ç—É –∂–µ –∫–æ–ª–æ–Ω–∫—É
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –¢–û–õ–¨–ö–û –æ–¥–Ω–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ: "–ó–∞–¥–∞—á–∞ —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ"

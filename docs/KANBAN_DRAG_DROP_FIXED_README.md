# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Kanban Drag & Drop: –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –∑–∞–≤–∏—Å–∞—é—â–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤ –∏ –ª–æ–∂–Ω—ã—Ö —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

## –ü—Ä–æ–±–ª–µ–º—ã
1. **–ó–∞–≤–∏—Å–∞—é—â–∏–π –∫—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä** - –ø—Ä–∏ –ø–æ–ø—ã—Ç–∫–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∑–∞–¥–∞—á—É –≤ —Ç—É –∂–µ –∫–æ–ª–æ–Ω–∫—É –∫—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "‚ö†Ô∏è –ó–∞–¥–∞—á–∞ —É–∂–µ –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ" –Ω–µ –∏—Å—á–µ–∑–∞–ª
2. **–õ–æ–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** - –ø—Ä–æ–¥–æ–ª–∂–∞–ª–∏ –ø–æ—è–≤–ª—è—Ç—å—Å—è —Å–æ–æ–±—â–µ–Ω–∏—è "–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω", —Ö–æ—Ç—è —Å—Ç–∞—Ç—É—Å —Ä–µ–∞–ª—å–Ω–æ –Ω–µ –º–µ–Ω—è–ª—Å—è

## –†–µ—à–µ–Ω–∏—è

### 1. –£–ª—É—á—à–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ drag-—Å–æ—Å—Ç–æ—è–Ω–∏–π
–î–æ–±–∞–≤–ª–µ–Ω –º–µ—Ç–æ–¥ `clearAllDragStates()` –≤ `blog/static/js/pages/tasks/components/KanbanManager.js`:

```javascript
clearAllDragStates() {
    console.log('[KanbanManager] üßπ –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö drag-—Å–æ—Å—Ç–æ—è–Ω–∏–π');

    // –£–±–∏—Ä–∞–µ–º –≤—Å–µ –∫–ª–∞—Å—Å—ã drag-over –∏ drag-same-column
    const allDropZones = document.querySelectorAll('.kanban-column-content');
    allDropZones.forEach(zone => {
        zone.classList.remove('drag-over');
        zone.classList.remove('drag-same-column');
    });

    // –£–±–∏—Ä–∞–µ–º –∫–ª–∞—Å—Å dragging —Å–æ –≤—Å–µ—Ö –∫–∞—Ä—Ç–æ—á–µ–∫
    const allCards = document.querySelectorAll('.kanban-card');
    allCards.forEach(card => {
        card.classList.remove('dragging');
    });
}
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω handleDragLeave()
–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ —Ç–æ, —á—Ç–æ –º—ã—à—å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ø–æ–∫–∏–Ω—É–ª–∞ –∑–æ–Ω—É:

```javascript
handleDragLeave(event) {
    const dropZone = event.currentTarget;

    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –ª–∏ –º—ã—à—å –ø–æ–∫–∏–Ω—É–ª–∞ –∑–æ–Ω—É (–Ω–µ –ø–µ—Ä–µ—à–ª–∞ –Ω–∞ –¥–æ—á–µ—Ä–Ω–∏–π —ç–ª–µ–º–µ–Ω—Ç)
    if (!dropZone.contains(event.relatedTarget)) {
        dropZone.classList.remove('drag-over');
        dropZone.classList.remove('drag-same-column');
    }
}
```

### 3. –£–ª—É—á—à–µ–Ω handleDragEnd()
–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π:

```javascript
handleDragEnd(event) {
    console.log('[KanbanManager] ‚úÖ –ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ');

    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ—á–∏—â–∞–µ–º –≤—Å–µ drag-—Å–æ—Å—Ç–æ—è–Ω–∏—è
    this.clearAllDragStates();

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç–∏
    setTimeout(() => {
        this.clearAllDragStates();
    }, 100);
}
```

### 4. –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤
–î–æ–±–∞–≤–ª–µ–Ω–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ –∫ —Å—Ç—Ä–æ–∫–∞–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è:

```javascript
// –ü—Ä–∏–≤–æ–¥–∏–º —Å—Ç–∞—Ç—É—Å—ã –∫ —Å—Ç—Ä–æ–∫–∞–º –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
const currentStatusStr = String(currentStatusId);
const newStatusStr = String(newStatusId);

console.log('[KanbanManager] üìã –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤:', { currentStatusStr, newStatusStr });

if (currentStatusStr === newStatusStr) {
    // –û—Ç–º–µ–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é
}
```

### 5. –ì–ª–æ–±–∞–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏
–î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `window.emergencyDragCleanup()` –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–π –æ—á–∏—Å—Ç–∫–∏:

```javascript
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
window.emergencyDragCleanup();
```

## –£–ª—É—á—à–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
- **`blog/static/js/pages/tasks/components/KanbanManager.js`** - –æ—Å–Ω–æ–≤–Ω—ã–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ª–æ–≥–∏–∫–∏
- **`blog/static/css/pages/tasks/tasks.css`** - —Å—Ç–∏–ª–∏ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω—ã—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤

## –†–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ **–ö—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∏—Å—á–µ–∑–∞–µ—Ç** –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è drag –æ–ø–µ—Ä–∞—Ü–∏–∏
- ‚úÖ **–£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –ª–æ–∂–Ω—ã–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –æ —Å–º–µ–Ω–µ —Å—Ç–∞—Ç—É—Å–∞
- ‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** –æ—á–∏—Å—Ç–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π
- ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏** –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤
- ‚úÖ **–£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω—ã –ª–∏—à–Ω–∏–µ API –∑–∞–ø—Ä–æ—Å—ã

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É `/tasks/my-tasks` –≤ —Ä–µ–∂–∏–º–µ Kanban
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∑–∞–¥–∞—á—É –≤ —Ç—É –∂–µ –∫–æ–ª–æ–Ω–∫—É, –≥–¥–µ –æ–Ω–∞ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
   - –ü–æ—è–≤–ª—è–µ—Ç—Å—è –∫—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Å –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ–º
   - –ö—Ä–∞—Å–Ω—ã–π –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä **–∏—Å—á–µ–∑–∞–µ—Ç** —á–µ—Ä–µ–∑ –∫–æ—Ä–æ—Ç–∫–æ–µ –≤—Ä–µ–º—è
   - –ù–ï –ø–æ—è–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ "–°—Ç–∞—Ç—É—Å –∏–∑–º–µ–Ω–µ–Ω"
   - –ü–æ—è–≤–ª—è–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ "–ó–∞–¥–∞—á–∞ —É–∂–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —ç—Ç–æ–º —Å—Ç–∞—Ç—É—Å–µ"
   - –ó–∞–¥–∞—á–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –≤ —Ç–æ–π –∂–µ –ø–æ–∑–∏—Ü–∏–∏

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
–ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã –ø–æ–≤—Ç–æ—Ä—è—Ç—Å—è, –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤ –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:

### 1. –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞ drag-—Å–æ—Å—Ç–æ—è–Ω–∏–π
```javascript
window.emergencyDragCleanup();
```

### 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –∫–∞—Ä—Ç–æ—á–µ–∫ –∏ –∏—Ö —Å—Ç–∞—Ç—É—Å–æ–≤
```javascript
window.debugKanbanCards();
```
–≠—Ç–∞ —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–∫–∞–∂–µ—Ç –≤—Å–µ –∫–∞—Ä—Ç–æ—á–∫–∏ –Ω–∞ –¥–æ—Å–∫–µ, –∏—Ö ID, —Ç–µ–∫—É—â–∏–µ —Å—Ç–∞—Ç—É—Å—ã –∏ –∫–æ–ª–æ–Ω–∫–∏.

### 3. –û—Ç–ª–∞–¥–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ drag&drop
1. –û—Ç–∫—Ä–æ–π—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12)
2. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ç–∞—â–∏—Ç—å –∑–∞–¥–∞—á—É –≤ —Ç—É –∂–µ –∫–æ–ª–æ–Ω–∫—É
3. –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ –∏–∑—É—á–∏—Ç–µ –ª–æ–≥–∏ —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º `[KanbanManager]`
4. –û–±—Ä–∞—Ç–∏—Ç–µ –≤–Ω–∏–º–∞–Ω–∏–µ –Ω–∞:
   - –ù–∞–π–¥–µ–Ω–∞ –ª–∏ –∫–∞—Ä—Ç–æ—á–∫–∞ –∑–∞–¥–∞—á–∏
   - –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –ª–∏ –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è —Ç–µ–∫—É—â–∏–π –∏ –Ω–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å—ã
   - –°—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ `if (currentStatusStr === newStatusStr)`
   - –í—ã–≤–æ–¥–∏—Ç—Å—è –ª–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ `–°–¢–ê–¢–£–°–´ –û–î–ò–ù–ê–ö–û–í–´–ï - –æ—Ç–º–µ–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é`

### 4. –ü—Ä–∏–º–µ—Ä –æ–∂–∏–¥–∞–µ–º—ã—Ö –ª–æ–≥–æ–≤ –ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç–µ
```
[KanbanManager] üîç –ü–æ–∏—Å–∫ –∫–∞—Ä—Ç–æ—á–∫–∏ –∑–∞–¥–∞—á–∏ —Å ID: 176275
[KanbanManager] üîç –ù–∞–π–¥–µ–Ω–æ –∫–∞—Ä—Ç–æ—á–µ–∫ —Å ID 176275 : 1
[KanbanManager] üìã –¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏: 2 (—Ç–∏–ø: string)
[KanbanManager] üìã –ù–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å: 2 (—Ç–∏–ø: string)
[KanbanManager] üìã –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–æ–≤ (—Å—Ç—Ä–æ–∫–∏): {currentStatusStr: "2", newStatusStr: "2", —Ä–∞–≤–Ω—ã: true, —Å—Ç—Ä–æ–≥–æ–†–∞–≤–Ω—ã: true}
[KanbanManager] ‚ö†Ô∏è –°–¢–ê–¢–£–°–´ –û–î–ò–ù–ê–ö–û–í–´–ï - –æ—Ç–º–µ–Ω—è–µ–º –æ–ø–µ—Ä–∞—Ü–∏—é
[KanbanManager] ‚ö†Ô∏è RETURN - —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≤–µ—Ä—à–∞–µ—Ç—Å—è –∑–¥–µ—Å—å
```
